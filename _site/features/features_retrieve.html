<html>
  <head>
    <meta content='text/html;charset=UTF-8' http-equiv='Content-Type'>
    <title>GeoIQ &mdash; Filtered Features API</title>
    <style type='text/css'>
      @import '/css/default.css';
      @import '/css/syntax.css';
    </style>
    <style media='print' type='text/css'>
      @import '/css/print.css';
    </style>
    <meta content='GeoIQ API' name='subject'>
    <link href='/images/favicon.png' rel='shortcut icon'>
  </head>
  <body>
    <div id='wrap'>
      <div id='header'>
        <a href='http://fortiusone.github.com/api' title="GeoIQ API"></a>
        <div class='tagline'>GeoIQ API</div>
      </div>
      <div id='pages'>
        <ol class='toc'>
          <li>Start Here
            <ol class="toc">
              <li><a href='/index.html'>Welcome</a></li>
              <li><a href='/tutorial.html'>Quick Start</a></li>
              <li><a href='https://github.com/fortiusone/api/wiki'>Community Wiki</a></li>
            </ol>
          </li>
          <li>REST API
            <ol class="toc">
              <li><a href='/methods.html'>Methods</a></li>
              <li><a href="/analysis.html">Analysis</a></li>
              <li><a href="/chart.html">Chart</a></li>
              <li><a href="/configurations.html">Configurations</a></li>
              <li><a href="/filter.html">Filter</a></li>
              <li><a href="/groups.html">Groups</a></li>
              <li><a href="/features/index.html">Data Features</a>
                <ol class="toc">
                  <li><a href="/features/features_create.html">Create</a></li>
                  <li><a href="/features/features_retrieve.html">Read</a></li>
                  <li><a href="/features/features_delete.html">Delete</a></li>
                </ol></li>
            </ol>
          </li>
          <li>JavaScript API
            <ol class="toc">
              <li><a href="/javascript.html">Javascript</a>
              <li><a href="/javascript/methods.html">Javascript Methods</a>
            </ol>
          </li>          
          <li>Examples
            <ol class="toc">
              <li><a href='/examples/dashboard.html'>Dashboard Example</a></li>
              <li><a href='/examples/map.html'>Map Example</a></li>
              <li><a href='/examples/map_drawing.html'>Map Drawing Example</a></li>
              <li><a href='/examples/editing_features.html'>Editing Features Example</a></li>
              <li><a href='/examples/map_search'>Map Search Example</a></li>
              <li><a href='http://getsatisfaction.com/geocommons'>Troubleshooting</a></li>
            </ol>
          </li>
        </ol>
      </div>
      <div id='content'>
        <h1 id='filtered features api'>Filtered Features API</h1>
        <p><strong>Required Parameters:</strong> (none)</p>
<p><strong>Optional Parameters</strong>:</p>
<table>
	<tr>
		<th>Parameter </th>
		<th>Description </th>
		<th>Example </th>
	</tr>
	<tr>
		<td>limit</td>
		<td>number of features to return (default is 30)</td>
		<td>limit=2</td>
	</tr>
	<tr>
		<td>order</td>
		<td>&#8216;ascending&#8217; or &#8216;descending&#8217; of the sort attribute (default ascending)</td>
		<td>order=descending</td>
	</tr>
	<tr>
		<td>start</td>
		<td>index to start with. 1 would be the first. Allows paginating through data</td>
		<td>start=6</td>
	</tr>
	<tr>
		<td>callback</td>
		<td>callback method to wrap the response in</td>
		<td> callback=filteredLayer </td>
	</tr>
	<tr>
		<td>bbox</td>
		<td>West/South/East/North is the order of the bounding box to get the features contained within an area</td>
		<td>bbox=-79.5,20,-78,50</td>
	</tr>
	<tr>
		<td>units</td>
		<td>sets the unit for the radius parameter by default is km (requires radius parameter)possible options are: km,m,ft,miles,degrees</td>
		<td>units=ft</td>
	</tr>
	<tr>
		<td>lon</td>
		<td>longitude of a point being searched from requires use of radius and lat parameters additionally</td>
		<td>lon=-77.9998</td>
	</tr>
	<tr>
		<td>lat</td>
		<td>latitude of a point being search from requires use of the radius and lon parameters additionally</td>
		<td>lat=39.8282</td>
	</tr>
	<tr>
		<td>radius</td>
		<td>defines distanced to be search from of a polygon,line,points or lat/lon pair (default is km)</td>
		<td>radius=100</td>
	</tr>
	<tr>
		<td>intersect</td>
		<td>specify if polygons are <em>contained</em> or <em>full</em>. By default is set to <em>contained</em> which means only polygons completely inside the buffer will be returned, <em>full</em> means any part inside or touching</td>
		<td>intersect=contained</td>
		<td> <br />
|with_distance</td>
		<td>set to &#8220;true&#8221; to get a distance calculation of the centroid of the feature to the boundary polygon sent back with the features.</td>
		<td>with_distance=1</td>
	</tr>
	<tr>
		<td>filter</td>
		<td>filter parameters for specific attributes within the dataset</td>
		<td> filter[dec_col][][max]=.22 </td>
	</tr>
	<tr>
		<td>group_by</td>
		<td>array of columns to &#8220;group by&#8221; in aggregating features</td>
		<td>group_by[]=state</td>
	</tr>
	<tr>
		<td>aggregates</td>
		<td>array of aggregation values. Includes by name and calc. Name is the attribute name and calc can be any of: max,min,sum,average</td>
		<td>aggregates[][name]=timestamp&amp;aggregates[][calc]=max</td>
	</tr>
	<tr>
		<td>geojson</td>
		<td>returns the geometry in GeoJSON format</td>
		<td>geojson=1</td>
	</tr>
	<tr>
		<td>hex_geometry</td>
		<td>returns the geometry in <span class="caps">HEX</span> <span class="caps">EWKB</span> format</td>
		<td>hex_geometry=1</td>
	</tr>
	<tr>
		<td>encode</td>
		<td>returns the geometry in Google Maps encoded polyline format</td>
		<td>encode=1</td>
	</tr>
</table>
<p><em>all latitude and longitude is in decimal degrees</em></p>
<p><strong>Curl Examples:</strong></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?bbox=-79.5,20,-78,50</code></pre>
<p><em>Filter features within a bounding box</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?lat=39.2&amp;lon=-77.1&amp;radius=100</code></pre>
<p><em>Filter features within 100 km of a point</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?points=-77.1,39.8,-77.2,39.9,-77.3,39.99,-77.1,39.8&amp;radius=100</code></pre>
<p><em>Filter features within 100 kilometers of multiple points by longitude,latitude</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?polygon=-77,34,-78.5,34.5,-82,32,-79,30,-77,34&amp;radius=100</code></pre>
<p><em>Filter features within a 100 kilometer distance of a polygon</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?line=-77,34,-78.5,34.5,-82,32,-79,30&amp;radius=100</code></pre>
<p><em>Filter features within 100 km of a geographic line (such as a road)</em></p>
<pre><code>curl http://geocommons.com/datasets/22146/features.json?lat=38.8&amp;lon=-78.9&amp;radius=2&amp;intersect=full</code></pre>
<p><em>Filter features within or overlapping 2 km of a point</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?filter[int_col][][equals]=1&amp;filter[dec_col][][max]=.22</code></pre>
<p><em>Filter features where int_col is equal to 1 and dec_col is less than 0.22</em></p>
<p><strong>Filter Parameters</strong>:</p>
<p>Datasets can be filtered when requested from the server. This is done by calling the dataset/:id/features/ with the optional filter= paramter. The filter parameter can include a filter for any attribute name, and an array of filter conditions. Filter names must be <span class="caps">URI</span> encoded.</p>
<table>
	<tr>
		<th>Parameters </th>
		<th>Description</th>
		<th>Example </th>
	</tr>
	<tr>
		<td>min</td>
		<td>the minimum value of the attribute</td>
		<td>filter[financing_amt][][min]=100</td>
	</tr>
	<tr>
		<td>max</td>
		<td>the maximum value of the attribute</td>
		<td>filter[financing_amt][][max]=120</td>
	</tr>
	<tr>
		<td>equals</td>
		<td>the value the attribute must be equal to</td>
		<td>filter[name][][equals]=bob</td>
	</tr>
</table>
<pre>http://geocommons.com/datasets/98696/features.json?filter[int_col][][max]=5&amp;filter[name][][equals]=point%201</code></pre>
<pre>http://geocommons.com/datasets/98696/features.json?filter[int_col][][max]=5&amp;filter[int_col][][min]=3</code></pre>
<h2>Aggregate Statistics</h2>
<p>Using the Feature <span class="caps">API</span> it&#8217;s possible to calculate roll-up statistics of features. Using the <code>group_by</code> and <code>aggregates</code> you can specify to summarize max,min,sum, or average values. If a <code>group_by</code> is specified but no aggregates, then just a count is returned of the number of features in that group.</p>
<h3>group_by</h3>
<p>The <code>group_by</code> option groups features based on the value of the attribute specified. This ends up with summarized data, by default with a count and optionally with additional <code>aggregates</code> as specified below.</p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?group_by[]=sortable</code></pre>
<h3>aggregates</h3>
<p>The <code>aggregates</code> option is an array of objects that contain both a <code>name</code> and a <code>calc</code>. So for example: <code>aggregates[][name]=cost&amp;aggregates[][calc]=average</code>. A request can have multiple aggregates.</p>
<p>The calc parameter can be any of:</p>
<ul>
	<li>max &#8211; maximum value of all attribute features</li>
	<li>min &#8211; minimum value of all attribute features</li>
	<li>sum &#8211; summation of all values</li>
	<li>average &#8211; average of all values</li>
</ul>
<p><strong>Example</strong></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?aggregates[][name]=int_col&amp;aggregates[][calc]=sum&amp;group_by[]=sortable</code></pre>
        <p><strong>Required Parameters:</strong> (none)</p>
<p><strong>Optional Parameters</strong>:</p>
<table>
	<tr>
		<th>Parameter </th>
		<th>Description </th>
		<th>Example </th>
	</tr>
	<tr>
		<td>limit</td>
		<td>number of features to return (default is 30)</td>
		<td>limit=2</td>
	</tr>
	<tr>
		<td>order</td>
		<td>&#8216;ascending&#8217; or &#8216;descending&#8217; of the sort attribute (default ascending)</td>
		<td>order=descending</td>
	</tr>
	<tr>
		<td>start</td>
		<td>index to start with. 1 would be the first. Allows paginating through data</td>
		<td>start=6</td>
	</tr>
	<tr>
		<td>callback</td>
		<td>callback method to wrap the response in</td>
		<td> callback=filteredLayer </td>
	</tr>
	<tr>
		<td>bbox</td>
		<td>West/South/East/North is the order of the bounding box to get the features contained within an area</td>
		<td>bbox=-79.5,20,-78,50</td>
	</tr>
	<tr>
		<td>units</td>
		<td>sets the unit for the radius parameter by default is km (requires radius parameter)possible options are: km,m,ft,miles,degrees</td>
		<td>units=ft</td>
	</tr>
	<tr>
		<td>lon</td>
		<td>longitude of a point being searched from requires use of radius and lat parameters additionally</td>
		<td>lon=-77.9998</td>
	</tr>
	<tr>
		<td>lat</td>
		<td>latitude of a point being search from requires use of the radius and lon parameters additionally</td>
		<td>lat=39.8282</td>
	</tr>
	<tr>
		<td>radius</td>
		<td>defines distanced to be search from of a polygon,line,points or lat/lon pair (default is km)</td>
		<td>radius=100</td>
	</tr>
	<tr>
		<td>intersect</td>
		<td>specify if polygons are <em>contained</em> or <em>full</em>. By default is set to <em>contained</em> which means only polygons completely inside the buffer will be returned, <em>full</em> means any part inside or touching</td>
		<td>intersect=contained</td>
		<td> <br />
|with_distance</td>
		<td>set to &#8220;true&#8221; to get a distance calculation of the centroid of the feature to the boundary polygon sent back with the features.</td>
		<td>with_distance=1</td>
	</tr>
	<tr>
		<td>filter</td>
		<td>filter parameters for specific attributes within the dataset</td>
		<td> filter[dec_col][][max]=.22 </td>
	</tr>
	<tr>
		<td>group_by</td>
		<td>array of columns to &#8220;group by&#8221; in aggregating features</td>
		<td>group_by[]=state</td>
	</tr>
	<tr>
		<td>aggregates</td>
		<td>array of aggregation values. Includes by name and calc. Name is the attribute name and calc can be any of: max,min,sum,average</td>
		<td>aggregates[][name]=timestamp&amp;aggregates[][calc]=max</td>
	</tr>
	<tr>
		<td>geojson</td>
		<td>returns the geometry in GeoJSON format</td>
		<td>geojson=1</td>
	</tr>
	<tr>
		<td>hex_geometry</td>
		<td>returns the geometry in <span class="caps">HEX</span> <span class="caps">EWKB</span> format</td>
		<td>hex_geometry=1</td>
	</tr>
	<tr>
		<td>encode</td>
		<td>returns the geometry in Google Maps encoded polyline format</td>
		<td>encode=1</td>
	</tr>
</table>
<p><em>all latitude and longitude is in decimal degrees</em></p>
<p><strong>Curl Examples:</strong></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?bbox=-79.5,20,-78,50</code></pre>
<p><em>Filter features within a bounding box</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?lat=39.2&amp;lon=-77.1&amp;radius=100</code></pre>
<p><em>Filter features within 100 km of a point</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?points=-77.1,39.8,-77.2,39.9,-77.3,39.99,-77.1,39.8&amp;radius=100</code></pre>
<p><em>Filter features within 100 kilometers of multiple points by longitude,latitude</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?polygon=-77,34,-78.5,34.5,-82,32,-79,30,-77,34&amp;radius=100</code></pre>
<p><em>Filter features within a 100 kilometer distance of a polygon</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?line=-77,34,-78.5,34.5,-82,32,-79,30&amp;radius=100</code></pre>
<p><em>Filter features within 100 km of a geographic line (such as a road)</em></p>
<pre><code>curl http://geocommons.com/datasets/22146/features.json?lat=38.8&amp;lon=-78.9&amp;radius=2&amp;intersect=full</code></pre>
<p><em>Filter features within or overlapping 2 km of a point</em></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?filter[int_col][][equals]=1&amp;filter[dec_col][][max]=.22</code></pre>
<p><em>Filter features where int_col is equal to 1 and dec_col is less than 0.22</em></p>
<p><strong>Filter Parameters</strong>:</p>
<p>Datasets can be filtered when requested from the server. This is done by calling the dataset/:id/features/ with the optional filter= paramter. The filter parameter can include a filter for any attribute name, and an array of filter conditions. Filter names must be <span class="caps">URI</span> encoded.</p>
<table>
	<tr>
		<th>Parameters </th>
		<th>Description</th>
		<th>Example </th>
	</tr>
	<tr>
		<td>min</td>
		<td>the minimum value of the attribute</td>
		<td>filter[financing_amt][][min]=100</td>
	</tr>
	<tr>
		<td>max</td>
		<td>the maximum value of the attribute</td>
		<td>filter[financing_amt][][max]=120</td>
	</tr>
	<tr>
		<td>equals</td>
		<td>the value the attribute must be equal to</td>
		<td>filter[name][][equals]=bob</td>
	</tr>
</table>
<pre>http://geocommons.com/datasets/98696/features.json?filter[int_col][][max]=5&amp;filter[name][][equals]=point%201</code></pre>
<pre>http://geocommons.com/datasets/98696/features.json?filter[int_col][][max]=5&amp;filter[int_col][][min]=3</code></pre>
<h2>Aggregate Statistics</h2>
<p>Using the Feature <span class="caps">API</span> it&#8217;s possible to calculate roll-up statistics of features. Using the <code>group_by</code> and <code>aggregates</code> you can specify to summarize max,min,sum, or average values. If a <code>group_by</code> is specified but no aggregates, then just a count is returned of the number of features in that group.</p>
<h3>group_by</h3>
<p>The <code>group_by</code> option groups features based on the value of the attribute specified. This ends up with summarized data, by default with a count and optionally with additional <code>aggregates</code> as specified below.</p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?group_by[]=sortable</code></pre>
<h3>aggregates</h3>
<p>The <code>aggregates</code> option is an array of objects that contain both a <code>name</code> and a <code>calc</code>. So for example: <code>aggregates[][name]=cost&amp;aggregates[][calc]=average</code>. A request can have multiple aggregates.</p>
<p>The calc parameter can be any of:</p>
<ul>
	<li>max &#8211; maximum value of all attribute features</li>
	<li>min &#8211; minimum value of all attribute features</li>
	<li>sum &#8211; summation of all values</li>
	<li>average &#8211; average of all values</li>
</ul>
<p><strong>Example</strong></p>
<pre><code>curl http://geocommons.com/datasets/98696/features.json?aggregates[][name]=int_col&amp;aggregates[][calc]=sum&amp;group_by[]=sortable</code></pre>
      </div>
      <div id='footer'>Copyright &copy; 2008-2011 GeoIQ</div>
    </div>
  </body>
</html>
